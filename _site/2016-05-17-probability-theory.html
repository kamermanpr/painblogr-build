<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" >

<!-- Head --------------------------------------------------------->

<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="generator" content="pandoc"/>
	
	
	 <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
 <meta name="viewport" content="width=device-width, initial-scale=1" />
 <link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
 <script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
 <script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
 <script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
 <script src="site_libs/navigation-1.1/tabsets.js"></script>
 <script src="site_libs/navigation-1.1/codefolding.js"></script> 

	
		<style type="text/css">
		code {
			white-space: pre;
		}
	</style>
	<style type="text/css">
		a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */  div.sourceCode {
			overflow-x: visible;
		}
		
	</style>

		<style type="text/css">
		pre:not([class]) {
			background-color: white;
		}
	</style>
	   	<style type="text/css">
		h1 {
			font-size: 34px;
		}

		h1.title {
			font-size: 38px;
		}

		h2 {
			font-size: 30px;
		}

		h3 {
			font-size: 24px;
		}

		h4 {
			font-size: 18px;
		}

		h5 {
			font-size: 16px;
		}

		h6 {
			font-size: 12px;
		}

		.table th:not([align]) {
			text-align: left;
		}

		
	</style>
	
		<link rel="stylesheet" href="css/custom.css" type="text/css" />  
    <!-- Latest maxdcn font-awesome and academicons -->
    <link rel="stylesheet" href="./css/font-awesome-4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="./css/academicons-1.7.0/css/academicons.min.css">

    <!-- custom css -->
        <link rel="stylesheet" href="css/custom.css" type="text/css" />
	
    <!-- Include these sections here, otherwise YAML headings not inserted -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-71613331-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-71613331-1');
    </script>

    <!-- SEO -->
    <title>The gganimate package in action: Probability theory</title>
    <meta name="description" content="Using the gganimate package to illustrate the central limit theorem, and law of large numbers.">
    <link rel="author" href="https://plus.google.com/u/0/103355314187199079295" />
    <meta name="robots" content="robots.txt">
    <link rel="canonical" href="https://www.painblogr.org/2016-05-17-probability-theory.html">

    <!-- Twittercard -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@painblogR">
    <meta name="twitter:creator" content="@painblogR">
    <meta name="twitter:title" content="The gganimate package in action: Probability theory">
    <meta name="twitter:description" content="Using the gganimate package to illustrate the central limit theorem, and law of large numbers.">
    <meta name="twitter:image" content="./images/posts/2016-05-17-probability-theory/post-image.png">
    <meta name="twitter:url" content="https://www.painblogr.org/2016-05-17-probability-theory.html">

    <!-- Opengraph -->
    <meta property="og:title" content="The gganimate package in action: Probability theory">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://www.painblogr.org/2016-05-17-probability-theory.html">
    <meta property="og:image" content="./images/posts/2016-05-17-probability-theory/post-image.png">
    <meta property="og:description" content="Using the gganimate package to illustrate the central limit theorem, and law of large numbers.">
    <meta property="og:site_name" content="painblogR">
    <meta property="fb:app_id" content="621412384962188">
</head>

<!-- Body --------------------------------------------------------->

<body>
    <!-- Navigation bar -->
    <nav class="navbar navbar-fixed-top" role="navigation" , style="background-color:#FFFFFF;border-bottom: 1px solid #CCCCCC;">
        <div class="container-fluid" id="navfluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar-collapse" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <img src="images/capsaicin.png" alt="logo" , style="max-height:60px;padding-top:5px;">
                <span class="site-title"><a href="https://www.painblogr.org" style="color:#000000;font-size:250%;vertical-align:middle;">
				painblogR</a></span>&emsp;
            </div>

            <div class="collapse navbar-collapse" id="bs-navbar-collapse">
                <ul class="nav navbar-nav" style="display:table-row;padding-top:7px">
                    <li style="display:table-cell;float:none;vertical-align:middle;font-size:16px;"><a href="https://www.painblogr.org">Home</a></li>
                    <li style="display:table-cell;float:none;vertical-align:middle;font-size:16px;"><a href="./archive.html">Archive</a></li>
                    <li class="dropdown" style="display:table-cell;float:none;vertical-align:middle;font-size:16px;">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About<span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a href="./about_me.html">About me</a></li>
                            <li role="separator" class="divider"></li>
                            <li><a href="./publications.html">Publications & Reprints </a></li>
                        </ul>
                    </li>
                    <li class="dropdown" style="display:table-cell;float:none;vertical-align:middle;font-size:16px;">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Teaching<span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a href="https://www.painblogr.org/biostatistics/">Introduction to Biostatistics</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
            <!-- /. nav-collapse -->
        </div>
        <!-- /. container-fluid -->
    </nav>

	<!-- Extras -->
		<style type = "text/css">
		code {
  			color: inherit;
  			background-color: rgba(0, 0, 0, 0.04);
		}
		img {
  			max-width:100%;
  			height: auto;
		}
		.tabbed-pane {
  			padding-top: 12px;
		}
		button.code-folding-btn:focus {
  			outline: none;
		}
	</style>

	<div class="container-fluid main-container">
		<!-- tabsets -->
		<script src="/tabsets.js"></script>
		<script>
			$(document).ready(function () {
  			window.buildTabsets("TOC");
			});
		</script>

		<!-- code folding -->
				<style type="text/css">
			code-folding-btn { margin-bottom: 4px; }
		</style>
		<script src="/codefolding.js"></script>
					<script>

		$(document).ready(function () {
			
			  			window.initializeCodeFolding("show" === "show");
					});
		</script>
		
		<div class="fluid-row" id="header">
<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>

    <!-- Main text --->
    <div class="container-fluid" id="mainbody">
         
        <h1>The gganimate package in action: Probability theory</h1> 
        <h4>Peter Kamerman</h4> 
        <em>17 May 2016</em> <p><em>(I updated this post on 27 January 2019 to reflect the new <code>gganimate</code> API that <a href="//github.com/thomasp85/gganimate">Thomas Pedersen</a> introduced)</em></p>
<div id="background" class="section level2">
<h2>Background</h2>
<p>I have wanted to try David Robinson’s <em>(and now also Thomas Pedersen)</em> <a href="//github.com/thomasp85/gganimate">gganimate</a> package since I came across it a few months ago. The package extends Hadley Wickham’s <a href="//ggplot2.tidyverse.org/index.html">ggplot2</a> package by including the description of animation. It does this by providing a range of new grammar classes that can be added to the plot object in order to customise how it should change with time.</p>
<ul>
<li><code>transition_*()</code> defines how the data should be spread out and how it relates to itself across time.</li>
<li><code>view_*()</code> defines how the positional scales should change along the animation.</li>
<li><code>shadow_*()</code> defines how data from other points in time should be presented in the given point in time.</li>
<li><code>enter_*()</code>/<code>exit_*()</code> defines how new data should appear and how old data should disappear during the course of the animation.</li>
<li><code>ease_aes()</code> defines how different aesthetics should be eased during transitions.</li>
</ul>
<p>Recently, the opportunity to put one of the package’s <code>transition_*()</code> functions to work while I was preparing materials for an <a href="//painblogr.org/biostatistics/">introductory biostatistics</a> tutorial for undergrad students. I wanted to demonstrate the <em>central limit theorem</em> and <em>law of large numbers</em>, and thought that animations would help deliver the message.</p>
<p>The <em>central limit theorem</em> provides a shortcut to knowing the sampling distribution, which is the probability distribution of a statistic (e.g., mean, proportion) for all possible samples from a population. The theorem is one of the cornerstones of probability theory because it allows you to make statements about the sampling distribution for a particular statistic without having to sample the entire population. As such, it forms the basis of statistical inference.</p>
<p>The <em>central limit theorem</em> states that the sampling distribution of an independent, random variable is normal or near-normal if a sufficiently large number of (equal-sized) samples are taken. If the sampling distribution for a statistic follows a normal or near-normal distribution we can make probability statements about the range of values in which the statistic lies. For example, there is a 68% probability that the sample statistic is within 1 standard deviation of the population value, and a 95% probability that it lies within about 2 standard deviations (see figure below). In the case of the sampling distribution, the standard deviation of the distribution is also called the <em>standard error</em>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Generate data for a standard normal distribution and 1/2 SD range</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">2019</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">density &lt;-<span class="st"> </span><span class="kw">density</span>(<span class="kw">rnorm</span>(<span class="dv">100000</span>), <span class="dt">n =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">density &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> density<span class="op">$</span>x,</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">                  <span class="dt">y =</span> density<span class="op">$</span>y)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">density_sd &lt;-<span class="st"> </span>density <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="st">    </span><span class="kw">filter</span>(x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-1</span> <span class="op">&amp;</span><span class="st"> </span>x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">density_sd2 &lt;-<span class="st"> </span>density <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="st">    </span><span class="kw">filter</span>(x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-2</span> <span class="op">&amp;</span><span class="st"> </span>x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12"></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co"># Plot</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="st">    </span><span class="kw">aes</span>(<span class="dt">x =</span> x,</a>
<a class="sourceLine" id="cb1-16" data-line-number="16">        <span class="dt">y =</span> y) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="st">    </span><span class="kw">geom_area</span>(<span class="dt">data =</span> density_sd2,</a>
<a class="sourceLine" id="cb1-18" data-line-number="18">              <span class="dt">fill =</span> <span class="st">&#39;#66AAD0&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="st">    </span><span class="kw">geom_area</span>(<span class="dt">data =</span> density_sd,</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">              <span class="dt">fill =</span> <span class="st">&#39;#0072B2&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="st">    </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">min</span>(density_sd<span class="op">$</span>x), </a>
<a class="sourceLine" id="cb1-22" data-line-number="22">                     <span class="dt">xend =</span> <span class="kw">max</span>(density_sd<span class="op">$</span>x), </a>
<a class="sourceLine" id="cb1-23" data-line-number="23">                     <span class="dt">y =</span> density_sd[density_sd<span class="op">$</span>x <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(density_sd<span class="op">$</span>x), ]<span class="op">$</span>y, </a>
<a class="sourceLine" id="cb1-24" data-line-number="24">                     <span class="dt">yend =</span> density_sd[density_sd<span class="op">$</span>x <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(density_sd<span class="op">$</span>x), ]<span class="op">$</span>y),</a>
<a class="sourceLine" id="cb1-25" data-line-number="25">                 <span class="dt">size =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1-26" data-line-number="26">                 <span class="dt">colour =</span> <span class="st">&#39;#FFFFFF&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="st">    </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">min</span>(density_sd2<span class="op">$</span>x), </a>
<a class="sourceLine" id="cb1-28" data-line-number="28">                     <span class="dt">xend =</span> <span class="kw">max</span>(density_sd2<span class="op">$</span>x), </a>
<a class="sourceLine" id="cb1-29" data-line-number="29">                     <span class="dt">y =</span> density_sd2[density_sd2<span class="op">$</span>x <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(density_sd2<span class="op">$</span>x), ]<span class="op">$</span>y, </a>
<a class="sourceLine" id="cb1-30" data-line-number="30">                     <span class="dt">yend =</span> density_sd2[density_sd2<span class="op">$</span>x <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(density_sd2<span class="op">$</span>x), ]<span class="op">$</span>y),</a>
<a class="sourceLine" id="cb1-31" data-line-number="31">                 <span class="dt">size =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1-32" data-line-number="32">                 <span class="dt">colour =</span> <span class="st">&#39;#FFFFFF&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-33" data-line-number="33"><span class="st">    </span><span class="kw">geom_label</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb1-34" data-line-number="34">                   <span class="dt">y =</span> density_sd[density_sd<span class="op">$</span>x <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(density_sd<span class="op">$</span>x), ]<span class="op">$</span>y,</a>
<a class="sourceLine" id="cb1-35" data-line-number="35">                   <span class="dt">label =</span> <span class="st">&#39;1 SD: 68%&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36"><span class="st">    </span><span class="kw">geom_label</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb1-37" data-line-number="37">                   <span class="dt">y =</span> density_sd2[density_sd2<span class="op">$</span>x <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(density_sd2<span class="op">$</span>x), ]<span class="op">$</span>y,</a>
<a class="sourceLine" id="cb1-38" data-line-number="38">                   <span class="dt">label =</span> <span class="st">&#39;1.96 SD: 95%&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-39" data-line-number="39"><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">data =</span> density) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-40" data-line-number="40"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-41" data-line-number="41"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">Standard deviation&#39;</span>,</a>
<a class="sourceLine" id="cb1-42" data-line-number="42">         <span class="dt">y =</span> <span class="st">&#39;Density</span><span class="ch">\n</span><span class="st">&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-43" data-line-number="43"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">17</span>),</a>
<a class="sourceLine" id="cb1-44" data-line-number="44">          <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">17</span>),</a>
<a class="sourceLine" id="cb1-45" data-line-number="45">          <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">17</span>),</a>
<a class="sourceLine" id="cb1-46" data-line-number="46">          <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb1-47" data-line-number="47">          <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;gray80&#39;</span>, </a>
<a class="sourceLine" id="cb1-48" data-line-number="48">                                          <span class="dt">size =</span> <span class="fl">0.3</span>),</a>
<a class="sourceLine" id="cb1-49" data-line-number="49">          <span class="dt">panel.background =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="2016-05-17-probability-theory_files/figure-html/normal_distr-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The size of the standard error also allows us to gauge the precision of the sample statistic, and this <em>‘width’</em> of the sampling distribution is dependent on the size of the samples. From a technical point of view, the standard error of the sample statistic is equal to the standard deviation of the population divided by the square root of the sample size (<span class="math inline">\(se = \frac{\sigma}{\sqrt{n}}\)</span>). Basically, as the size of a sample increases the samples are more likely to be representative of the population, and therefore variability around the point estimate should decrease. The figure below shows the effect of increasing sample size on the precision of the standard error.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Generate data of SEM as sample size from a std normal population increases</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">2019</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">population &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">200000</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">interval &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">5</span>, <span class="dt">to =</span> <span class="dv">1000</span>, <span class="dt">by =</span> <span class="dv">50</span>), </a>
<a class="sourceLine" id="cb2-5" data-line-number="5">              <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1050</span>, <span class="dt">to =</span> <span class="dv">10000</span>, <span class="dt">by =</span> <span class="dv">1000</span>), <span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">sem &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(interval))</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(interval)){</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">    sem[[i]] &lt;-<span class="st"> </span><span class="kw">sd</span>(<span class="kw">sample</span>(<span class="dt">x =</span> population, <span class="dt">size =</span> interval[[i]]) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(interval[[i]]))</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">    sem</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">}</a>
<a class="sourceLine" id="cb2-12" data-line-number="12"></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">sem_plot &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> interval, <span class="dt">y =</span> sem)</a>
<a class="sourceLine" id="cb2-14" data-line-number="14"></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co"># Plot</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="kw">ggplot</span>(sem_plot) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="st">    </span><span class="kw">aes</span>(<span class="dt">x =</span> x,</a>
<a class="sourceLine" id="cb2-18" data-line-number="18">        <span class="dt">y =</span> y) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">colour =</span> <span class="st">&#39;#0072B2&#39;</span>,</a>
<a class="sourceLine" id="cb2-20" data-line-number="20">              <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb2-22" data-line-number="22">               <span class="dt">colour =</span> <span class="st">&quot;#E69F00&quot;</span>, </a>
<a class="sourceLine" id="cb2-23" data-line-number="23">               <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10000</span>),</a>
<a class="sourceLine" id="cb2-25" data-line-number="25">                       <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">500</span>, <span class="dv">1000</span>, </a>
<a class="sourceLine" id="cb2-26" data-line-number="26">                                  <span class="dv">2500</span>, <span class="dv">5000</span>, <span class="dv">7500</span>, <span class="dv">10000</span>),</a>
<a class="sourceLine" id="cb2-27" data-line-number="27">                       <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;0&#39;</span>, <span class="st">&#39;500&#39;</span>, <span class="st">&#39;1000&#39;</span>, </a>
<a class="sourceLine" id="cb2-28" data-line-number="28">                                  <span class="st">&#39;2500&#39;</span>, <span class="st">&#39;5000&#39;</span>, <span class="st">&#39;7500&#39;</span>, <span class="st">&#39;10000&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.12</span>),</a>
<a class="sourceLine" id="cb2-30" data-line-number="30">                       <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.04</span>, <span class="fl">0.08</span>, <span class="fl">0.12</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-31" data-line-number="31"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&#39;Standard error of the mean vs. sample size&#39;</span>,</a>
<a class="sourceLine" id="cb2-32" data-line-number="32">         <span class="dt">subtitle =</span> <span class="st">&#39;(Population: N = 200 000, mean = 0, SD = 1)&#39;</span>,</a>
<a class="sourceLine" id="cb2-33" data-line-number="33">         <span class="dt">x =</span> <span class="st">&#39;Sample size&#39;</span>, </a>
<a class="sourceLine" id="cb2-34" data-line-number="34">         <span class="dt">y =</span> <span class="st">&#39;Standard error of the mean</span><span class="ch">\n</span><span class="st">&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-35" data-line-number="35"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">17</span>),</a>
<a class="sourceLine" id="cb2-36" data-line-number="36">          <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">17</span>),</a>
<a class="sourceLine" id="cb2-37" data-line-number="37">          <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">17</span>, <span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">vjust =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-38" data-line-number="38">          <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">17</span>),</a>
<a class="sourceLine" id="cb2-39" data-line-number="39">          <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb2-40" data-line-number="40">          <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;gray80&#39;</span>, </a>
<a class="sourceLine" id="cb2-41" data-line-number="41">                                          <span class="dt">size =</span> <span class="fl">0.3</span>),</a>
<a class="sourceLine" id="cb2-42" data-line-number="42">          <span class="dt">panel.background =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="2016-05-17-probability-theory_files/figure-html/SEM_reduction-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This leads us to the <em>law of large numbers</em>. At a simplistic level, the central limit theorem tells us about the shape of the sampling distribution, while the law of large numbers tells us where the centre of the distribution lies. From the law of large numbers we can show that the cumulative result from a large number of trials/samples tends towards the true value in the population. That is, the probability of an unusual outcome becomes smaller as the number of trials/samples increases. This convergence in probability is also called the <em>weak law of large numbers</em>.</p>
</div>
<div id="gganimate-the-theories-in-action" class="section level2">
<h2>gganimate: the theories in action</h2>
<p>I used the <code>transition_reveal()</code> function from the <code>gganimate</code> package to put the two theories into motion.</p>
<div id="our-population" class="section level3">
<h3>Our population</h3>
<p>The <em>central limit theorem</em> holds across different distributions, and to illustrate this point I started with a population generated by taking a random sample (<em>N</em> = 200,000) from the exponential distribution (right-skewed) with rate 1.</p>
<p>The density distribution of this dataset is shown in the figure below (the mean is marked by the orange line), and it served as the population from which samples were taken to demonstrate the central limit theorem and the law of large numbers.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># Generate data using a random sample from the exponential distribution</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">2019</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">distr &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">data =</span> <span class="kw">rexp</span>(<span class="dv">200000</span>))</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co"># Plot</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="kw">ggplot</span>(distr, <span class="kw">aes</span>(data)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_density</span>(<span class="dt">fill =</span> <span class="st">&#39;#0072B2&#39;</span>, </a>
<a class="sourceLine" id="cb3-8" data-line-number="8">                 <span class="dt">colour =</span> <span class="st">&#39;#0072B2&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">mean</span>(distr<span class="op">$</span>data), </a>
<a class="sourceLine" id="cb3-10" data-line-number="10">               <span class="dt">colour =</span> <span class="st">&quot;#E69F00&quot;</span>, </a>
<a class="sourceLine" id="cb3-11" data-line-number="11">               <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">14</span>),</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">                       <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">14</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">                       <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">Value&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;Probability</span><span class="ch">\n</span><span class="st">&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">17</span>),</a>
<a class="sourceLine" id="cb3-18" data-line-number="18">          <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">17</span>),</a>
<a class="sourceLine" id="cb3-19" data-line-number="19">          <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">17</span>),</a>
<a class="sourceLine" id="cb3-20" data-line-number="20">          <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb3-21" data-line-number="21">          <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;gray80&#39;</span>, </a>
<a class="sourceLine" id="cb3-22" data-line-number="22">                                          <span class="dt">size =</span> <span class="fl">0.3</span>),</a>
<a class="sourceLine" id="cb3-23" data-line-number="23">          <span class="dt">panel.background =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="2016-05-17-probability-theory_files/figure-html/skewed_population-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="the-central-limit-theorem-in-action" class="section level3">
<h3>The central limit theorem in action</h3>
<p>To demonstrate the central limit theorem, I took 5000 samples (without replacement) of <em>n</em> = 200 each from the ‘population’ of 200,000, and calculated the mean for each sample. I then tabulated the frequency at which sample means occurred across the 5000 samples, and used these data to plot a frequency histogram. However, in addition to the usual ggplot2 code, I added the function <code>gganimate::transition_reveal(along = sample)</code> to the final line of the plot code. Adding this additional function allows the <code>gganimate::animate()</code> function to take the <code>ggplot2</code> object and to sequentially add the frequency bins of sample means as frames in an animation.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Generate data</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co"># Create an empty list, and a &#39;for loop&#39; counter</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">lst &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">cnt &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5000</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co"># Take 5000 samples of n = 200 from &#39;population&#39; and make a list of sample means.</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="kw">set.seed</span>(<span class="dv">2019</span>)</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="cf">for</span>(i <span class="cf">in</span> cnt){</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">    lst[[i]] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sample</span>(population, <span class="dt">size =</span> <span class="dv">200</span>))</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb4-11" data-line-number="11"></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co"># Process data in &#39;lst&#39; for plotting</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">## Unlist and round to reduce the number of bins for CLT plot</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14">lst2 &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">unlist</span>(lst), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-15" data-line-number="15"></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">## cross-tabulate the data to get frequency bins</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17">tab &lt;-<span class="st"> </span><span class="kw">xtabs</span>(<span class="op">~</span>lst2)</a>
<a class="sourceLine" id="cb4-18" data-line-number="18"></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">## Extract the names (&#39;bins&#39;)</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20">nam &lt;-<span class="st"> </span><span class="kw">names</span>(tab)</a>
<a class="sourceLine" id="cb4-21" data-line-number="21"></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">## Make data.frame for plotting</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23">df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">sample =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(tab)),</a>
<a class="sourceLine" id="cb4-24" data-line-number="24">             <span class="dt">mean =</span> <span class="kw">as.numeric</span>(nam),</a>
<a class="sourceLine" id="cb4-25" data-line-number="25">             <span class="dt">freq =</span> <span class="kw">as.numeric</span>(tab))</a>
<a class="sourceLine" id="cb4-26" data-line-number="26"></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co"># Plot the data</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28">clt &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> df) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="st">    </span><span class="kw">aes</span>(<span class="dt">y =</span> freq, </a>
<a class="sourceLine" id="cb4-30" data-line-number="30">        <span class="dt">x =</span> mean,</a>
<a class="sourceLine" id="cb4-31" data-line-number="31">        <span class="dt">group =</span> sample) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&#39;identity&#39;</span>,</a>
<a class="sourceLine" id="cb4-33" data-line-number="33">             <span class="dt">fill =</span> <span class="st">&#39;#0072B2&#39;</span>, </a>
<a class="sourceLine" id="cb4-34" data-line-number="34">             <span class="dt">colour =</span> <span class="st">&#39;#0072B2&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">mean</span>(population), </a>
<a class="sourceLine" id="cb4-36" data-line-number="36">               <span class="dt">colour =</span> <span class="st">&quot;#E69F00&quot;</span>, </a>
<a class="sourceLine" id="cb4-37" data-line-number="37">               <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.3</span>),</a>
<a class="sourceLine" id="cb4-39" data-line-number="39">                       <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.3</span>, <span class="fl">-0.2</span>, <span class="fl">-0.1</span>, <span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-40" data-line-number="40"><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">300</span>),</a>
<a class="sourceLine" id="cb4-41" data-line-number="41">                       <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-42" data-line-number="42"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">Sample mean&#39;</span>, </a>
<a class="sourceLine" id="cb4-43" data-line-number="43">         <span class="dt">y =</span> <span class="st">&#39;Frequency</span><span class="ch">\n</span><span class="st">&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-44" data-line-number="44"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb4-45" data-line-number="45">          <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb4-46" data-line-number="46">          <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb4-47" data-line-number="47">          <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb4-48" data-line-number="48">          <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;gray80&#39;</span>,</a>
<a class="sourceLine" id="cb4-49" data-line-number="49">                                          <span class="dt">size =</span> <span class="fl">0.3</span>),</a>
<a class="sourceLine" id="cb4-50" data-line-number="50">          <span class="dt">panel.background =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-51" data-line-number="51"><span class="st">    </span><span class="kw">transition_reveal</span>(<span class="dt">along =</span> sample)</a>
<a class="sourceLine" id="cb4-52" data-line-number="52"></a>
<a class="sourceLine" id="cb4-53" data-line-number="53"><span class="co"># Animate plots with animate</span></a>
<a class="sourceLine" id="cb4-54" data-line-number="54">clt_animate &lt;-<span class="st"> </span><span class="kw">animate</span>(clt, </a>
<a class="sourceLine" id="cb4-55" data-line-number="55">                       <span class="dt">res =</span> <span class="dv">150</span>,</a>
<a class="sourceLine" id="cb4-56" data-line-number="56">                       <span class="dt">width =</span> <span class="dv">7</span>,</a>
<a class="sourceLine" id="cb4-57" data-line-number="57">                       <span class="dt">height =</span> <span class="dv">7</span>,</a>
<a class="sourceLine" id="cb4-58" data-line-number="58">                       <span class="dt">units =</span> <span class="st">&#39;in&#39;</span>) </a>
<a class="sourceLine" id="cb4-59" data-line-number="59"></a>
<a class="sourceLine" id="cb4-60" data-line-number="60"><span class="co"># Save the output</span></a>
<a class="sourceLine" id="cb4-61" data-line-number="61"><span class="kw">anim_save</span>(<span class="dt">filename =</span> <span class="st">&#39;central-limit.gif&#39;</span>,</a>
<a class="sourceLine" id="cb4-62" data-line-number="62">          <span class="dt">animation =</span> clt_animate, </a>
<a class="sourceLine" id="cb4-63" data-line-number="63">          <span class="dt">path =</span> <span class="st">&#39;./images/posts/2016-05-17-probability-theory&#39;</span>)</a></code></pre></div>
<p>The output is shown in the next figure, and as you can see, despite the samples being obtained from a right-skewed distribution, the distribution of sample means is roughly normal, and centred around the mean of the population (orange line).</p>
<p><img src="images/posts/2016-05-17-probability-theory/central-limit.gif"
style="display:block;margin-right:auto;margin-left:auto;max-width:50%;"></p>
</div>
<div id="the-law-of-large-numbers-in-action" class="section level3">
<h3>The law of large numbers in action</h3>
<p>To illustrate the <em>law of large numbers</em>, I took the 5000 sample means I had generated and calculated a cumulative mean across the samples. The cumulative mean was then plotted against the sample number in <code>ggplot2</code> with the function <code>gganimate::transition_reveal()</code> animating the plot by sequentially adding the cumulative mean as the number of resamples increased.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Process the data in &#39;lst2&#39; for plotting</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">## Calculate the cumulative mean for plotting</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">cumm_df &lt;-<span class="st"> </span>lst2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="st">    </span><span class="kw">tibble</span>(<span class="dt">mean =</span> .) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">cmean =</span> <span class="kw">round</span>(<span class="kw">cummean</span>(mean), <span class="dv">4</span>),</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">           <span class="dt">count =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(mean)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="st">    </span><span class="kw">select</span>(count, mean, cmean) </a>
<a class="sourceLine" id="cb5-8" data-line-number="8"></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">## Create a reduced cumm_df dataset</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10">index &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb5-11" data-line-number="11">             <span class="dt">to =</span> <span class="kw">nrow</span>(cumm_df), </a>
<a class="sourceLine" id="cb5-12" data-line-number="12">             <span class="dt">by =</span> <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb5-13" data-line-number="13">index[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"></a>
<a class="sourceLine" id="cb5-15" data-line-number="15">cumm_short &lt;-<span class="st"> </span>cumm_df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="st">    </span><span class="kw">filter</span>(count <span class="op">%in%</span><span class="st"> </span>index)</a>
<a class="sourceLine" id="cb5-17" data-line-number="17"></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co"># Plot the data</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19">lln &lt;-<span class="st"> </span><span class="kw">ggplot</span>(cumm_short, </a>
<a class="sourceLine" id="cb5-20" data-line-number="20">              <span class="kw">aes</span>(<span class="dt">y =</span> cmean, </a>
<a class="sourceLine" id="cb5-21" data-line-number="21">                  <span class="dt">x =</span> count)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">colour =</span> <span class="st">&#39;#0072B2&#39;</span>,</a>
<a class="sourceLine" id="cb5-23" data-line-number="23">              <span class="dt">size =</span> <span class="fl">0.8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(population), </a>
<a class="sourceLine" id="cb5-25" data-line-number="25">               <span class="dt">colour =</span> <span class="st">&quot;#E69F00&quot;</span>, </a>
<a class="sourceLine" id="cb5-26" data-line-number="26">               <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">Sample number&#39;</span>, </a>
<a class="sourceLine" id="cb5-28" data-line-number="28">         <span class="dt">y =</span> <span class="st">&#39;Cumulative mean</span><span class="ch">\n</span><span class="st">&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-29" data-line-number="29"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb5-30" data-line-number="30">          <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb5-31" data-line-number="31">          <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb5-32" data-line-number="32">          <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb5-33" data-line-number="33">          <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&#39;gray80&#39;</span>, <span class="dt">size =</span> <span class="fl">0.3</span>),</a>
<a class="sourceLine" id="cb5-34" data-line-number="34">          <span class="dt">panel.background =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-35" data-line-number="35"><span class="st">    </span><span class="kw">transition_reveal</span>(<span class="dt">along =</span> count)</a>
<a class="sourceLine" id="cb5-36" data-line-number="36"></a>
<a class="sourceLine" id="cb5-37" data-line-number="37"><span class="co"># Animate plots with gg_animate</span></a>
<a class="sourceLine" id="cb5-38" data-line-number="38">lln_animate &lt;-<span class="st"> </span><span class="kw">animate</span>(lln, </a>
<a class="sourceLine" id="cb5-39" data-line-number="39">                       <span class="dt">res =</span> <span class="dv">150</span>,</a>
<a class="sourceLine" id="cb5-40" data-line-number="40">                       <span class="dt">width =</span> <span class="dv">7</span>,</a>
<a class="sourceLine" id="cb5-41" data-line-number="41">                       <span class="dt">height =</span> <span class="dv">7</span>,</a>
<a class="sourceLine" id="cb5-42" data-line-number="42">                       <span class="dt">units =</span> <span class="st">&#39;in&#39;</span>) </a>
<a class="sourceLine" id="cb5-43" data-line-number="43"></a>
<a class="sourceLine" id="cb5-44" data-line-number="44"><span class="co"># Save the output</span></a>
<a class="sourceLine" id="cb5-45" data-line-number="45"><span class="kw">anim_save</span>(<span class="dt">filename =</span> <span class="st">&#39;law-large-numbers.gif&#39;</span>,</a>
<a class="sourceLine" id="cb5-46" data-line-number="46">          <span class="dt">animation =</span> lln_animate, </a>
<a class="sourceLine" id="cb5-47" data-line-number="47">          <span class="dt">path =</span> <span class="st">&#39;./images/posts/2016-05-17-probability-theory&#39;</span>)</a></code></pre></div>
<p>The resulting figure is shown below, and shows the cumulative mean of sample means getting closer to the population mean as the number of samples increases.</p>
<p><img src="images/posts/2016-05-17-probability-theory/law-large-numbers.gif"
style="display:block;margin-right:auto;margin-left:auto;max-width:50%;"></p>
<p>So there you have it, the central limit theorem and the law of large numbers graphically illustrated using the awesome gganimate package in combination with ggplot2. Making the creation of animated ggplots simple.</p>
<hr />
</div>
<div id="oops" class="section level3">
<h3>Oops</h3>
<p>The little I know about stats is dangerous, so if you spot an error please let me know by submitting an <a href="//github.com/kamermanpr/painblogr-build/issues">issue</a> on GitHub or by adding a comment below.</p>
</div>
</div>

        <!-- Include these sections here, otherwise YAML headings not inserted -->
        <!-- Share -->
        <div class="share">
            <p style="display:inline-block">
                <hr>
                <h3>Share</h3>&ensp;
                <a href="mailto:?subject=The gganimate package in action: Probability theory&body=Hi, I thought you might like this post I found on painblogR:%0D%0A%0D%0Ahttps://www.painblogr.org/2016-05-17-probability-theory.html.%0D%0A%0D%0ABest regards" target="_blank"><i class="fa fa-envelope" style="color:#000000;vertical-align:middle;" title="Share on email" ></i></a>&ensp;
                <a href="https://twitter.com/intent/tweet?url=https://www.painblogr.org/2016-05-17-probability-theory.html&text=The gganimate package in action: Probability theory&via=painblogR" rel="nofollow" target="_blank" title="Share on Twitter"><i class="fa fa-twitter" style="color:#000000;vertical-align:middle;"></i></a>&ensp;
                <a href="https://facebook.com/sharer.php?u=https://www.painblogr.org/2016-05-17-probability-theory.html" rel="nofollow" target="_blank" title="Share on Facebook"><i class="fa fa-facebook" style="color:#000000;vertical-align:middle;"></i></a>&ensp;
                <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.painblogr.org/2016-05-17-probability-theory.html" rel="nofollow" target="_blank" title="Share on LinkedIn"><i class="fa fa-linkedin" style="color:#000000;vertical-align:middle;"></i></a>
            </p>
        </div>

        <!-- Disqus
        <div class="comments">
            <hr>
            <h3>Comments</h3>
            <div id="disqus_thread"></div>
            <script>
                var disqus_config = function() {
                    this.page.url = 'https://www.painblogr.org/2016-05-17-probability-theory.html'
                    this.page.identifier = '/2016-05-17-probability-theory.html'
                };

                (function() {
                    var d = document,
                        s = d.createElement('script');

                    s.src = 'https://www.painblogr.disqus.com/embed.js';
                    s.setAttribute('data-timestamp', +new Date());
                    (d.head || d.body).appendChild(s);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
            </noscript>
        </div>
    </div> -->

    <!-- Footer -->
    <footer>
         <!--footer-->
 <div class="container-fluid" id="foot" style="background-color:#FFFFFF;border-top:#CCCCCC solid 1px;color:#999999;font-family:'Open sans', 'Helvetica';">
     <div class="row">
         <div class="col-sm-4">
             <p>Hosted by: <a href="https://www.netlify.com" target="_blank">netlify.com</a>
                 <br>Powered by: <a href="http://rmarkdown.rstudio.com/" target="_blank">RMarkdown</a>
                 <br>
                 <br>
             </p>
         </div>
         <div class="col-sm-4">
             <p>Fork/clone from: <a href="https://github.com/kamermanpr/kamermanpr.github.io.git" target="_blank">GitHub</a>
                 <br>License: <a href="./LICENSE.html" target="_blank">MIT & CC-BY 4.0</a>
                 <br>
                 <br>
             </p>
         </div>
         <div class="col-sm-4">
             <h4 style="padding:0;margin:0">painblogR</h3>
 			   <p style="display:inline-block">
 				   <span style="font-style:italic">by Peter Kamerman</span>
 				   &ensp;
 				   <a href="mailto:peter.kamerman@gmail.com" title="Email me" target="_blank"><i style="color:#999999;" class="fa fa-envelope"></i></a>
 				   &ensp;
 				   <a href="//twitter.com/@painblogR" target="_blank" title="Follow me"><i style="color:#999999;" class="fa fa-twitter"></i></a>
 			   </p>
 		   </div>
 	   </div>
 	</div> 
    </footer>
</body>

<!-- extras ------------------------------------------------------->
<!-- Mathjax -->

</html>
